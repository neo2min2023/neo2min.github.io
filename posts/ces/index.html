<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>CES production function | Research Notes</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/mathjax.css" />
    
    
    
    
    
    

<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true,
      tags: 'ams'
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });
</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  

    
<script src="/js_lib/plotly-2.20.0.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.1.1/d3.js"></script>


  </head>

  <body>
    <nav>
    <ul class="menu">
      
    </ul>
    <hr/>
    </nav>


    <h2>CES production function</h2>
    <h4>2023-05-01 21:25:14 &#43;0800 CST</h4>
    <aside>
        <nav id="TableOfContents">
  <ol>
    <li><a href="#ces-production-function">CES production function</a></li>
    <li><a href="#sympy-solution-to-cost-minimization">sympy solution to cost minimization</a></li>
    <li><a href="#3d-plot-of-cost-minimization">3D plot of cost minimization</a></li>
    <li><a href="#2d-plot-of-cost-minization">2D plot of cost minization</a>
      <ol>
        <li><a href="#theoretic-value-of-elasticity-of-substitution">theoretic value of elasticity of substitution:</a></li>
        <li><a href="#numerical-approximation-of-elasticity-of-substitution">numerical approximation of elasticity of substitution:</a></li>
      </ol>
    </li>
    <li><a href="#special-cases-of-ces">Special cases of CES</a>
      <ol>
        <li><a href="#2d-comparison-of-different-elasticity-of-substitution">2d comparison of different elasticity of substitution</a></li>
      </ol>
    </li>
  </ol>
</nav>
    </aside>
    <hr>
    <h1 id="ces-production-function">CES production function</h1>
<p>$Q = F \cdot \left(a \cdot K^{\rho } + (1−a) \cdot L^{\rho }\right)^{\frac{\upsilon }{\rho }}$</p>
<p>where</p>
<ul>
<li>$Q$ = Quantity of output</li>
<li>$F$ = <a href="https://en.wikipedia.org/wiki/Total_factor_productivity" title="Total factor productivity">Factor productivity</a></li>
<li>$a$ = Share parameter</li>
<li>$K$ = Quantities of primary production factors (Capital and Labor)</li>
<li>$\rho $ = Substitution parameter</li>
<li>$\sigma $ = $\frac{1}{1-\rho}$ <a href="https://en.wikipedia.org/wiki/Elasticity_of_substitution" title="Elasticity of substitution">Elasticity of substitution</a></li>
<li>$\upsilon $ &gt; 1 <strong>(Increasing return to scale)</strong>.</li>
</ul>
<p>As its name suggests, the CES production function exhibits constant elasticity of substitution between capital and labor. Leontief, linear and Cobb–Douglas functions are special cases of the CES production function. That is,</p>
<ul>
<li>If $\rho $ approaches 1, we have a <a href="https://en.wikipedia.org/wiki/Linear_utility" title="Linear utility">linear</a> or perfect substitutes function;</li>
<li>If $\rho $ approaches zero in the limit, we get the <a href="https://en.wikipedia.org/wiki/Cobb%E2%80%93Douglas_production_function" title="Cobb–Douglas production function">Cobb–Douglas production function</a>;</li>
<li>If $\rho $ approaches negative infinity we get the <a href="https://en.wikipedia.org/wiki/Leontief_production_function" title="Leontief production function">Leontief</a> or perfect complements production function.</li>
</ul>
<h1 id="sympy-solution-to-cost-minimization">sympy solution to cost minimization</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span><span style="color:#f92672">from</span> sympy <span style="color:#f92672">import</span> init_printing
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>init_printing() 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span><span style="color:#f92672">from</span> sympy <span style="color:#f92672">import</span> solve
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span><span style="color:#f92672">from</span> sympy.abc <span style="color:#f92672">import</span> k, l, q, r, w, alpha, beta, f
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>f <span style="color:#f92672">=</span> k<span style="color:#f92672">**</span>alpha <span style="color:#f92672">*</span> l<span style="color:#f92672">**</span>beta
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>eqs <span style="color:#f92672">=</span> [f<span style="color:#f92672">.</span>diff(k)<span style="color:#f92672">/</span>r <span style="color:#f92672">-</span> f<span style="color:#f92672">.</span>diff(l)<span style="color:#f92672">/</span>w, q <span style="color:#f92672">-</span> k<span style="color:#f92672">**</span>alpha <span style="color:#f92672">*</span> l<span style="color:#f92672">**</span>beta]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>eqs
</span></span></code></pre></div><p>$$ \left[ \frac{\alpha k^{\alpha} l^{\beta}}{k r} - \frac{\beta k^{\alpha} l^{\beta}}{l w}, \  - k^{\alpha} l^{\beta} + q\right]$$</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>soln <span style="color:#f92672">=</span> solve([f<span style="color:#f92672">.</span>diff(k)<span style="color:#f92672">/</span>r <span style="color:#f92672">-</span> f<span style="color:#f92672">.</span>diff(l)<span style="color:#f92672">/</span>w, q <span style="color:#f92672">-</span> k<span style="color:#f92672">**</span>alpha <span style="color:#f92672">*</span> l<span style="color:#f92672">**</span>beta], k, l, dict<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>soln[<span style="color:#ae81ff">1</span>]
</span></span></code></pre></div><!-- raw HTML omitted -->
<p>$$  \left[ k : \left(q \left(\left(\frac{\beta q^{\frac{1}{\alpha}} r}{\alpha w}\right)^{\frac{\alpha}{\alpha + \beta}}\right)^{- \beta}\right)^{\frac{1}{\alpha}}, \  l : \left(\frac{\beta q^{\frac{1}{\alpha}} r}{\alpha w}\right)^{\frac{\alpha}{\alpha + \beta}}\right]$$</p>
<h1 id="3d-plot-of-cost-minimization">3D plot of cost minimization</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>K <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0.25</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>L <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0.25</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>KK, LL <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(K, L)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>alpha <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>beta <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>QQ <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">*</span> (KK<span style="color:#f92672">**</span>(alpha) <span style="color:#f92672">*</span> LL<span style="color:#f92672">**</span>(beta))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>q0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>r <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.6</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>w <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>l0 <span style="color:#f92672">=</span> ((beta<span style="color:#f92672">*</span>r)<span style="color:#f92672">*</span>q0<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>alpha)<span style="color:#f92672">/</span>(alpha<span style="color:#f92672">*</span>w))<span style="color:#f92672">**</span>(alpha<span style="color:#f92672">/</span>(alpha<span style="color:#f92672">+</span>beta))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>k0 <span style="color:#f92672">=</span> (alpha<span style="color:#f92672">*</span>w)<span style="color:#f92672">*</span>l0<span style="color:#f92672">/</span>(beta<span style="color:#f92672">*</span>r)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>cost0 <span style="color:#f92672">=</span> r <span style="color:#f92672">*</span> k0 <span style="color:#f92672">+</span> w <span style="color:#f92672">*</span> l0 <span style="color:#75715e"># to identify the tagent line</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>cost <span style="color:#f92672">=</span> r <span style="color:#f92672">*</span> KK <span style="color:#f92672">+</span> w <span style="color:#f92672">*</span> LL
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>colorscale_cost <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;green&#39;</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;green&#39;</span>]]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>costSurface <span style="color:#f92672">=</span> go<span style="color:#f92672">.</span>Surface(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cost&#34;</span>, z<span style="color:#f92672">=</span>cost, x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L, showscale<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, opacity<span style="color:#f92672">=</span><span style="color:#ae81ff">0.4</span>, colorscale<span style="color:#f92672">=</span>colorscale_cost,  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>                         contours <span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;z&#34;</span>: dict(show<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, start<span style="color:#f92672">=</span>cost0<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, end<span style="color:#f92672">=</span>cost0<span style="color:#f92672">+</span><span style="color:#ae81ff">2</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, project_z<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, usecolormap<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;green&#34;</span>)})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>prodSurface <span style="color:#f92672">=</span> go<span style="color:#f92672">.</span>Surface(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;production&#34;</span>, z<span style="color:#f92672">=</span>QQ, x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L,  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>                         contours <span style="color:#f92672">=</span> { <span style="color:#e6db74">&#34;z&#34;</span>: {<span style="color:#e6db74">&#34;show&#34;</span>: <span style="color:#66d9ef">True</span>, <span style="color:#e6db74">&#34;start&#34;</span>: q0, <span style="color:#e6db74">&#34;end&#34;</span>: q0<span style="color:#f92672">+</span><span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#34;size&#34;</span>: <span style="color:#ae81ff">1.0</span>, <span style="color:#e6db74">&#34;project_z&#34;</span>:<span style="color:#66d9ef">True</span>, <span style="color:#e6db74">&#34;usecolormap&#34;</span>:<span style="color:#66d9ef">True</span>}},)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>stdSurface <span style="color:#f92672">=</span> go<span style="color:#f92672">.</span>Surface(name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;benchmark&#34;</span>, z<span style="color:#f92672">=</span>q0<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>ones(QQ<span style="color:#f92672">.</span>shape), x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L, showscale<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, opacity<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>l1 <span style="color:#f92672">=</span>  (q0<span style="color:#f92672">/</span>K<span style="color:#f92672">**</span>alpha)<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>beta)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>stdContour <span style="color:#f92672">=</span> go<span style="color:#f92672">.</span>Scatter3d(x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>l1, z<span style="color:#f92672">=</span>q0<span style="color:#f92672">*</span>np<span style="color:#f92672">.</span>ones(len(K)), marker<span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;color&#34;</span>:<span style="color:#e6db74">&#34;blue&#34;</span>, <span style="color:#e6db74">&#34;size&#34;</span>: <span style="color:#ae81ff">5</span>})
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>cylinder_x<span style="color:#f92672">=</span>K<span style="color:#f92672">.</span>reshape((<span style="color:#ae81ff">1</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))<span style="color:#f92672">.</span>repeat(<span style="color:#ae81ff">2</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>)  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>cylinder_y<span style="color:#f92672">=</span>l1<span style="color:#f92672">.</span>reshape((<span style="color:#ae81ff">1</span>,<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>))<span style="color:#f92672">.</span>repeat(<span style="color:#ae81ff">2</span>, axis<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>) 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>cylinder_z <span style="color:#f92672">=</span>  np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">6</span>, <span style="color:#ae81ff">2</span>)<span style="color:#f92672">.</span>reshape((<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">1</span>))<span style="color:#f92672">.</span>repeat(len(K),axis<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>colorscale_cyl <span style="color:#f92672">=</span> [[<span style="color:#ae81ff">0</span>, <span style="color:#e6db74">&#39;blue&#39;</span>], [<span style="color:#ae81ff">1</span>, <span style="color:#e6db74">&#39;blue&#39;</span>]]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>cyl1 <span style="color:#f92672">=</span> go<span style="color:#f92672">.</span>Surface(x<span style="color:#f92672">=</span>cylinder_x, y<span style="color:#f92672">=</span>cylinder_y, z<span style="color:#f92672">=</span>cylinder_z, colorscale <span style="color:#f92672">=</span> colorscale_cyl, showscale<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, opacity<span style="color:#f92672">=</span><span style="color:#ae81ff">0.1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>fig <span style="color:#f92672">=</span> go<span style="color:#f92672">.</span>Figure(data<span style="color:#f92672">=</span>[costSurface, prodSurface, stdSurface, cyl1, stdContour])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>fig<span style="color:#f92672">.</span>update_layout(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>    xaxis<span style="color:#f92672">=</span>dict(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;K&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>    yaxis<span style="color:#f92672">=</span>dict(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;L&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>    title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cost minimization&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>    legend_title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Legend Title&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>    font<span style="color:#f92672">=</span>dict(family<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Courier New, monospace&#34;</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">18</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;black&#34;</span> ),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>    autosize<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, width<span style="color:#f92672">=</span><span style="color:#ae81ff">1500</span>, height<span style="color:#f92672">=</span><span style="color:#ae81ff">900</span>, margin<span style="color:#f92672">=</span>dict(l<span style="color:#f92672">=</span><span style="color:#ae81ff">105</span>, r<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>, b<span style="color:#f92672">=</span><span style="color:#ae81ff">5</span>, t<span style="color:#f92672">=</span><span style="color:#ae81ff">100</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>fig<span style="color:#f92672">.</span>show()
</span></span></code></pre></div>

<div id="/image/CES/costMin3d.json" class="plotly" style="height:1000px"></div>
<script>
d3.json("/image/CES/costMin3d.json", function(err, fig) {
    Plotly.newPlot('\/image\/CES\/costMin3d.json', fig.data, fig.layout, {responsive: true});
});
</script>

<!-- raw HTML omitted -->
<!-- raw HTML omitted -->
<h1 id="2d-plot-of-cost-minization">2D plot of cost minization</h1>
<p>Note: the following code for dynamically depicting cost-minization problem in a 2d animation figure can work directly in jupyter notebook, but needs some more effort to get it work in <code>javascript</code>, thus not tuned in this page.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>x <span style="color:#f92672">=</span> K
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>y <span style="color:#f92672">=</span> (q0<span style="color:#f92672">/</span>x<span style="color:#f92672">**</span>alpha)<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>beta)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>xm <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>min(x) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>xM <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>max(x) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>ym <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>min(y) <span style="color:#f92672">-</span> <span style="color:#ae81ff">1.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>yM <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>max(y) <span style="color:#f92672">+</span> <span style="color:#ae81ff">1.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>s <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, N)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>xx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(x[<span style="color:#ae81ff">1</span>], x[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>], N)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>yy <span style="color:#f92672">=</span> (q0<span style="color:#f92672">/</span>xx<span style="color:#f92672">**</span>alpha)<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>beta)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>f_k <span style="color:#f92672">=</span> alpha<span style="color:#f92672">*</span>xx<span style="color:#f92672">**</span>(alpha<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> yy<span style="color:#f92672">**</span>beta
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>f_l <span style="color:#f92672">=</span> beta<span style="color:#f92672">*</span>xx<span style="color:#f92672">**</span>(alpha) <span style="color:#f92672">*</span> yy<span style="color:#f92672">**</span>(beta<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#75715e"># v=(vx, vy) is the velocity</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>vx <span style="color:#f92672">=</span> f_k
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>vy <span style="color:#f92672">=</span> f_l  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>speed <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(vx <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> vy <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>ux <span style="color:#f92672">=</span> vx <span style="color:#f92672">/</span> speed  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>uy <span style="color:#f92672">=</span> vy <span style="color:#f92672">/</span> speed
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span><span style="color:#75715e"># (ux, uy) unit normal vector, (-uy, ux) &amp; (uy, -ux)  unit normal vector</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>xend <span style="color:#f92672">=</span> xx <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>uy  <span style="color:#75715e"># end coordinates for the unit tangent vector at (xx, yy)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>yend <span style="color:#f92672">=</span> yy <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>ux
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>xend2 <span style="color:#f92672">=</span> xx <span style="color:#f92672">+</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>uy  <span style="color:#75715e"># end coordinates for the unit tangent vector at (xx, yy)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>yend2 <span style="color:#f92672">=</span> yy <span style="color:#f92672">-</span> <span style="color:#ae81ff">2</span><span style="color:#f92672">*</span>ux
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>xnoe <span style="color:#f92672">=</span> xx <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">*</span>ux  <span style="color:#75715e"># end coordinates for the unit normal vector at (xx,yy)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>ynoe <span style="color:#f92672">=</span> yy <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">*</span>uy
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span><span style="color:#75715e"># Create figure</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>fig <span style="color:#f92672">=</span> go<span style="color:#f92672">.</span>Figure(
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>    data<span style="color:#f92672">=</span>[go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>x, y<span style="color:#f92672">=</span>y, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;frame&#34;</span>, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines&#34;</span>, line<span style="color:#f92672">=</span>dict(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>          go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>x, y<span style="color:#f92672">=</span>y, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;curve&#34;</span>, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines&#34;</span>, line<span style="color:#f92672">=</span>dict(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>))],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>    layout<span style="color:#f92672">=</span>go<span style="color:#f92672">.</span>Layout(width<span style="color:#f92672">=</span><span style="color:#ae81ff">900</span>, height<span style="color:#f92672">=</span><span style="color:#ae81ff">900</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>                     xaxis<span style="color:#f92672">=</span>dict(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;K&#34;</span>,range<span style="color:#f92672">=</span>[xm, xM], autorange<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, zeroline<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>                     yaxis<span style="color:#f92672">=</span>dict(title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;L&#34;</span>,range<span style="color:#f92672">=</span>[ym, yM], autorange<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, zeroline<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>                     title<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;cost curve for different relative cost&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>                     hovermode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;closest&#34;</span>,
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>                     updatemenus<span style="color:#f92672">=</span>[dict(type<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;buttons&#34;</span>, buttons<span style="color:#f92672">=</span>[dict(label<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Play&#34;</span>, method<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;animate&#34;</span>, args<span style="color:#f92672">=</span>[<span style="color:#66d9ef">None</span>, {<span style="color:#e6db74">&#34;frame&#34;</span>: {<span style="color:#e6db74">&#34;duration&#34;</span>: <span style="color:#ae81ff">2000</span>, <span style="color:#e6db74">&#34;redraw&#34;</span>: <span style="color:#66d9ef">False</span>},}])])]),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>    frames<span style="color:#f92672">=</span>[go<span style="color:#f92672">.</span>Frame(data<span style="color:#f92672">=</span>[go<span style="color:#f92672">.</span>Scatter(mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines+text&#34;</span>, 
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>                     text<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;relative cost: </span><span style="color:#e6db74">{</span>np<span style="color:#f92672">.</span>round(ux[k]<span style="color:#f92672">/</span>uy[k],<span style="color:#ae81ff">1</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">f</span><span style="color:#e6db74">&#34;relative factor: </span><span style="color:#e6db74">{</span>np<span style="color:#f92672">.</span>round(xx[k]<span style="color:#f92672">/</span>yy[k],<span style="color:#ae81ff">1</span>)<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>], <span style="color:#75715e"># textposition=&#34;top left&#34;, # one text label for each point</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>                     x<span style="color:#f92672">=</span>[xx[k], xnoe[k], <span style="color:#66d9ef">None</span>, xend[k], xend2[k], <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">7</span>, <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">7</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>                     y<span style="color:#f92672">=</span>[yy[k], ynoe[k], <span style="color:#66d9ef">None</span>, yend[k], yend2[k], <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">6.5</span>, <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">7</span>],
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span>                     line<span style="color:#f92672">=</span>dict(color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>, width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>))]) <span style="color:#66d9ef">for</span> k <span style="color:#f92672">in</span> range(N)]
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span><span style="color:#75715e"># fig.update_layout(transition_duration=8000)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>fig<span style="color:#f92672">.</span>show()
</span></span></code></pre></div>

<div id="/image/CES/costMin2d.json" class="plotly" style="height:900px"></div>
<script>
d3.json("/image/CES/costMin2d.json", function(err, fig) {
    Plotly.newPlot('\/image\/CES\/costMin2d.json', fig.data, fig.layout, {responsive: true});
});
</script>

<!-- raw HTML omitted -->
<h2 id="theoretic-value-of-elasticity-of-substitution">theoretic value of elasticity of substitution:</h2>
<p>$$\sigma=\dfrac{d\ln\frac{l}{k}}{d\ln\frac{w}{r}}=\dfrac{d\ln\dfrac{\beta r}{\alpha w}}{d\ln\frac{w}{r}}=\dfrac{d\left(\ln\dfrac{\beta}{\alpha}-\ln\dfrac{w}{r}\right)}{d\ln\frac{w}{r}}=-1$$</p>
<h2 id="numerical-approximation-of-elasticity-of-substitution">numerical approximation of elasticity of substitution:</h2>
<p>$$\sigma\approx\dfrac{\Delta\ln\frac{l}{k}}{\Delta\ln\frac{w}{r}}$$</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>K2 <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>L2 <span style="color:#f92672">=</span> (q0<span style="color:#f92672">/</span>K2<span style="color:#f92672">**</span>alpha)<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>beta)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>relFactor <span style="color:#f92672">=</span> L2<span style="color:#f92672">/</span>K2
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>relCost <span style="color:#f92672">=</span> <span style="color:#f92672">-</span>alpha<span style="color:#f92672">*</span>L2<span style="color:#f92672">/</span>(beta<span style="color:#f92672">*</span>K2) <span style="color:#75715e"># -f_k/f_l</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1</span><span>ces0_df <span style="color:#f92672">=</span> pd<span style="color:#f92672">.</span>DataFrame(dict(K<span style="color:#f92672">=</span>K2, L<span style="color:#f92672">=</span>L2, relFactor<span style="color:#f92672">=</span>relFactor, relCost<span style="color:#f92672">=</span>relCost))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2</span><span>ces0_df[<span style="color:#e6db74">&#39;relF_lag&#39;</span>] <span style="color:#f92672">=</span> ces0_df[<span style="color:#e6db74">&#39;relFactor&#39;</span>]<span style="color:#f92672">.</span>shift(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3</span><span>ces0_df[<span style="color:#e6db74">&#39;relC_lag&#39;</span>] <span style="color:#f92672">=</span> ces0_df[<span style="color:#e6db74">&#39;relCost&#39;</span>]<span style="color:#f92672">.</span>shift(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4</span><span>ces0_df[<span style="color:#e6db74">&#39;relF_delta&#39;</span>] <span style="color:#f92672">=</span> ces0_df[<span style="color:#e6db74">&#39;relFactor&#39;</span>] <span style="color:#f92672">-</span> ces0_df[<span style="color:#e6db74">&#39;relFactor&#39;</span>]<span style="color:#f92672">.</span>shift(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5</span><span>ces0_df[<span style="color:#e6db74">&#39;relC_delta&#39;</span>] <span style="color:#f92672">=</span> ces0_df[<span style="color:#e6db74">&#39;relCost&#39;</span>] <span style="color:#f92672">-</span> ces0_df[<span style="color:#e6db74">&#39;relCost&#39;</span>]<span style="color:#f92672">.</span>shift(<span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6</span><span>ces0_df[<span style="color:#e6db74">&#39;sigma_approx&#39;</span>] <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>log(<span style="color:#f92672">-</span>ces0_df[<span style="color:#e6db74">&#39;relF_delta&#39;</span>]) <span style="color:#f92672">/</span> np<span style="color:#f92672">.</span>log(ces0_df[<span style="color:#e6db74">&#39;relC_delta&#39;</span>])
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7</span><span>ces0_df<span style="color:#f92672">.</span>head()
</span></span></code></pre></div><h1 id="special-cases-of-ces">Special cases of CES</h1>
<p>$$L = \left[ \dfrac{1}{1-a}\left[\left(\dfrac{Q}{F}\right)^{\frac{\rho}{v}}-a\cdot K^{\rho}\right]\right] ^{1/\rho}$$</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>K <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">30</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>v <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>F <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>q <span style="color:#f92672">=</span> <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span><span style="color:#75715e"># [[prod(k, l, F=1, a = 0.5, rho=-1e3, v=1) for k in K]  for l in [1,2]]</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#75715e"># sigma = infty, linear</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span>rho <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>L1 <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>a) <span style="color:#f92672">*</span> ((q<span style="color:#f92672">/</span>F)<span style="color:#f92672">**</span>(rho<span style="color:#f92672">/</span>v) <span style="color:#f92672">-</span> a<span style="color:#f92672">*</span>K<span style="color:#f92672">**</span>rho))<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>rho)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#75715e"># sigma = 1, Cobb-Douglas</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>rho <span style="color:#f92672">=</span> <span style="color:#ae81ff">1e-5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>L2 <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>a) <span style="color:#f92672">*</span> ((q<span style="color:#f92672">/</span>F)<span style="color:#f92672">**</span>(rho<span style="color:#f92672">/</span>v) <span style="color:#f92672">-</span> a<span style="color:#f92672">*</span>K<span style="color:#f92672">**</span>rho))<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>rho)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#75715e"># sigma = 0, linear</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>rho <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1e2</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>L3 <span style="color:#f92672">=</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>a) <span style="color:#f92672">*</span> ((q<span style="color:#f92672">/</span>F)<span style="color:#f92672">**</span>(rho<span style="color:#f92672">/</span>v) <span style="color:#f92672">-</span> a<span style="color:#f92672">*</span>K<span style="color:#f92672">**</span>rho))<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>rho)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span><span style="color:#75715e"># QQ3 = 1.2 * (a * KK**(-1e2) + (1-a) * LL**(-1e2))**(v/(-1e2))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span><span style="color:#75715e"># ces1_df= pd.DataFrame(dict(K=K, L1=L1, L2=L2, L3=L3))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span><span style="color:#75715e"># ces1_df.head()</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>fig <span style="color:#f92672">=</span> make_subplots(rows<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, cols<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span>fig<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L1), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>fig<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L2), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>fig<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L3), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>fig<span style="color:#f92672">.</span>update_layout(height<span style="color:#f92672">=</span><span style="color:#ae81ff">600</span>, width<span style="color:#f92672">=</span><span style="color:#ae81ff">1800</span>, title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Side By Side Subplots&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>fig<span style="color:#f92672">.</span>show()
</span></span></code></pre></div>

<div id="/image/CES/cesContour3cases.json" class="plotly" style="height:900px"></div>
<script>
d3.json("/image/CES/cesContour3cases.json", function(err, fig) {
    Plotly.newPlot('\/image\/CES\/cesContour3cases.json', fig.data, fig.layout, {responsive: true});
});
</script>

<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>K <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0.25</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>L <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>arange(<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>, <span style="color:#ae81ff">0.25</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>KK, LL <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>meshgrid(K, L)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>a <span style="color:#f92672">=</span> <span style="color:#ae81ff">0.4</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>v <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.0</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>QQ <span style="color:#f92672">=</span>  <span style="color:#ae81ff">1.2</span> <span style="color:#f92672">*</span> (a <span style="color:#f92672">*</span> KK<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span>) <span style="color:#f92672">+</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>a) <span style="color:#f92672">*</span> LL<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span>))<span style="color:#f92672">**</span>(v<span style="color:#f92672">/</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>QQ2 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.2</span> <span style="color:#f92672">*</span> (a <span style="color:#f92672">*</span> KK<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1e-3</span>) <span style="color:#f92672">+</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>a) <span style="color:#f92672">*</span> LL<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1e-3</span>))<span style="color:#f92672">**</span>(v<span style="color:#f92672">/</span><span style="color:#ae81ff">1e-3</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>QQ3 <span style="color:#f92672">=</span> <span style="color:#ae81ff">1.2</span> <span style="color:#f92672">*</span> (a <span style="color:#f92672">*</span> KK<span style="color:#f92672">**</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1e2</span>) <span style="color:#f92672">+</span> (<span style="color:#ae81ff">1</span><span style="color:#f92672">-</span>a) <span style="color:#f92672">*</span> LL<span style="color:#f92672">**</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1e2</span>))<span style="color:#f92672">**</span>(v<span style="color:#f92672">/</span>(<span style="color:#f92672">-</span><span style="color:#ae81ff">1e2</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span><span style="color:#75715e"># fig1 = go.Figure(data=go.Surface(name=&#34;production&#34;, z=QQ2, x=K, y=L, contours ={&#34;z&#34;: dict(show=True, start=3, end=9, size=1, project_z=True, usecolormap=True)}))</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#75715e"># fig1.show()</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span><span style="color:#75715e"># Initialize figure with 4 3D subplots</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>fig <span style="color:#f92672">=</span> make_subplots(rows<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, cols<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, specs<span style="color:#f92672">=</span>[[{<span style="color:#e6db74">&#39;type&#39;</span>: <span style="color:#e6db74">&#39;surface&#39;</span>}, {<span style="color:#e6db74">&#39;type&#39;</span>: <span style="color:#e6db74">&#39;surface&#39;</span>}, {<span style="color:#e6db74">&#39;type&#39;</span>: <span style="color:#e6db74">&#39;surface&#39;</span>}]], subplot_titles<span style="color:#f92672">=</span>(<span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$\sigma=\infty$&#34;</span>, <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$\sigma=1$&#34;</span>, <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$\sigma=0$&#34;</span>))
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span><span style="color:#75715e"># adding surfaces to subplots.</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>fig<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Surface(x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L, z<span style="color:#f92672">=</span>QQ, colorscale<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;Viridis&#39;</span>, showscale<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, contours <span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;z&#34;</span>: dict(show<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, start<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, end<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, project_z<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, usecolormap<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)}), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>fig<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Surface(x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L, z<span style="color:#f92672">=</span>QQ2, colorscale<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;RdBu&#39;</span>, showscale<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, contours <span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;z&#34;</span>: dict(show<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, start<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, end<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, project_z<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, usecolormap<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)}), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>fig<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Surface(x<span style="color:#f92672">=</span>K, y<span style="color:#f92672">=</span>L, z<span style="color:#f92672">=</span>QQ3, colorscale<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;YlOrRd&#39;</span>, showscale<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, contours <span style="color:#f92672">=</span>{<span style="color:#e6db74">&#34;z&#34;</span>: dict(show<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, start<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>, end<span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>, size<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, project_z<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>, usecolormap<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)}), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>camera <span style="color:#f92672">=</span> dict( up<span style="color:#f92672">=</span>dict(x<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, y<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, z<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>), center<span style="color:#f92672">=</span>dict(x<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, y<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>, z<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>), eye<span style="color:#f92672">=</span>dict(x<span style="color:#f92672">=</span><span style="color:#ae81ff">1.25</span>, y<span style="color:#f92672">=</span><span style="color:#ae81ff">1.05</span>, z<span style="color:#f92672">=</span><span style="color:#ae81ff">0.75</span>) )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>fig<span style="color:#f92672">.</span>update_layout(scene_camera<span style="color:#f92672">=</span>camera, title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;CES function for different sigma&#39;</span>, height<span style="color:#f92672">=</span><span style="color:#ae81ff">800</span>, width<span style="color:#f92672">=</span><span style="color:#ae81ff">1800</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>fig<span style="color:#f92672">.</span>show()
</span></span></code></pre></div>

<div id="/image/CES/ces3cases.json" class="plotly" style="height:900px"></div>
<script>
d3.json("/image/CES/ces3cases.json", function(err, fig) {
    Plotly.newPlot('\/image\/CES\/ces3cases.json', fig.data, fig.layout, {responsive: true});
});
</script>

<h2 id="2d-comparison-of-different-elasticity-of-substitution">2d comparison of different elasticity of substitution</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1</span><span>q0 <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2</span><span>x <span style="color:#f92672">=</span> K
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3</span><span>y <span style="color:#f92672">=</span> (q0<span style="color:#f92672">/</span>x<span style="color:#f92672">**</span>alpha)<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>beta)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4</span><span>N <span style="color:#f92672">=</span> <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5</span><span>s <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>, N)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6</span><span>xx <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>linspace(x[<span style="color:#ae81ff">1</span>], x[<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>], N)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7</span><span>yy <span style="color:#f92672">=</span> (q0<span style="color:#f92672">/</span>xx<span style="color:#f92672">**</span>alpha)<span style="color:#f92672">**</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">/</span>beta)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8</span><span>f_k <span style="color:#f92672">=</span> alpha<span style="color:#f92672">*</span>xx<span style="color:#f92672">**</span>(alpha<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>) <span style="color:#f92672">*</span> yy<span style="color:#f92672">**</span>beta
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9</span><span>f_l <span style="color:#f92672">=</span> beta<span style="color:#f92672">*</span>xx<span style="color:#f92672">**</span>(alpha) <span style="color:#f92672">*</span> yy<span style="color:#f92672">**</span>(beta<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10</span><span><span style="color:#75715e"># v=(vx, vy) is the velocity</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11</span><span>vx <span style="color:#f92672">=</span> f_k
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12</span><span>vy <span style="color:#f92672">=</span> f_l  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13</span><span>speed <span style="color:#f92672">=</span> np<span style="color:#f92672">.</span>sqrt(vx <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span> <span style="color:#f92672">+</span> vy <span style="color:#f92672">**</span> <span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14</span><span>ux <span style="color:#f92672">=</span> vx <span style="color:#f92672">/</span> speed  
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15</span><span>uy <span style="color:#f92672">=</span> vy <span style="color:#f92672">/</span> speed
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17</span><span><span style="color:#75715e"># (ux, uy) unit normal vector, (-uy, ux) &amp; (uy, -ux)  unit normal vector</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18</span><span>xend <span style="color:#f92672">=</span> xx <span style="color:#f92672">-</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>uy  <span style="color:#75715e"># end coordinates for the unit tangent vector at (xx, yy)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19</span><span>yend <span style="color:#f92672">=</span> yy <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>ux
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21</span><span>xend2 <span style="color:#f92672">=</span> xx <span style="color:#f92672">+</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>uy  <span style="color:#75715e"># end coordinates for the unit tangent vector at (xx, yy)</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22</span><span>yend2 <span style="color:#f92672">=</span> yy <span style="color:#f92672">-</span> <span style="color:#ae81ff">3</span><span style="color:#f92672">*</span>ux
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25</span><span>fig2 <span style="color:#f92672">=</span> make_subplots(rows<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, cols<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27</span><span>fig2<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>x, y<span style="color:#f92672">=</span>y, name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;CD-isoquant&#34;</span>, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines&#34;</span>, line<span style="color:#f92672">=</span>dict(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28</span><span><span style="color:#75715e"># fig2.add_trace( go.Scatter(x=[xend[1], xend2[1], None, xend[6], xend2[6]], y=[yend[1], yend2[1], None, yend[6], yend2[6]], name=&#34;CD-isocost&#34;, mode=&#34;lines&#34;, line=dict(width=2, color=&#34;red&#34;)), row=1, col=1 )</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29</span><span>fig2<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>[xend[<span style="color:#ae81ff">1</span>], xend2[<span style="color:#ae81ff">1</span>], <span style="color:#66d9ef">None</span>, xend[<span style="color:#ae81ff">6</span>], xend2[<span style="color:#ae81ff">6</span>], <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">6</span>], y<span style="color:#f92672">=</span>[yend[<span style="color:#ae81ff">1</span>], yend2[<span style="color:#ae81ff">1</span>], <span style="color:#66d9ef">None</span>, yend[<span style="color:#ae81ff">6</span>], yend2[<span style="color:#ae81ff">6</span>], <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">16</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;linear-isoquant&#34;</span>,   textfont<span style="color:#f92672">=</span>dict(size<span style="color:#f92672">=</span><span style="color:#ae81ff">28</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;green&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30</span><span>                           text<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$\frac{\Delta (l/k)}{\Delta (w/r)} =1$&#34;</span>], mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines+text&#34;</span>, line<span style="color:#f92672">=</span>dict(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>)), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32</span><span>fig2<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>[<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>,<span style="color:#66d9ef">None</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">8</span>], y<span style="color:#f92672">=</span>[<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">8</span>,<span style="color:#66d9ef">None</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">3</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Leontief-isoquant&#34;</span>, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines&#34;</span>, line<span style="color:#f92672">=</span>dict(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33</span><span><span style="color:#75715e"># fig2.add_trace( go.Scatter(x=[2,4,None,1,5], y=[5,1,None,4,2], name=&#34;Leontief-isoquant&#34;, mode=&#34;lines&#34;, line=dict(width=2, color=&#34;red&#34;)), row=1, col=2 )</span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34</span><span>fig2<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>[<span style="color:#ae81ff">2</span>,<span style="color:#ae81ff">4</span>,<span style="color:#66d9ef">None</span>,<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">5</span>, <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">6</span>], y<span style="color:#f92672">=</span>[<span style="color:#ae81ff">5</span>,<span style="color:#ae81ff">1</span>,<span style="color:#66d9ef">None</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">2</span>, <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">6</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;linear-isoquant&#34;</span>,  textfont<span style="color:#f92672">=</span>dict(size<span style="color:#f92672">=</span><span style="color:#ae81ff">28</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;green&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35</span><span>                           text<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$\frac{\Delta (l/k)}{\Delta (w/r)} =0$&#34;</span>], mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines+text&#34;</span>, line<span style="color:#f92672">=</span>dict(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>)), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37</span><span>fig2<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">8</span>], y<span style="color:#f92672">=</span>[<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">1</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;linear-isoquant&#34;</span>, mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines&#34;</span>, line<span style="color:#f92672">=</span>dict(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;blue&#34;</span>)), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38</span><span>fig2<span style="color:#f92672">.</span>add_trace( go<span style="color:#f92672">.</span>Scatter(x<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>,<span style="color:#ae81ff">3</span>,<span style="color:#66d9ef">None</span>,<span style="color:#ae81ff">4</span>,<span style="color:#ae81ff">8</span>, <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">6</span>], y<span style="color:#f92672">=</span>[<span style="color:#ae81ff">8</span>,<span style="color:#ae81ff">4</span>,<span style="color:#66d9ef">None</span>,<span style="color:#ae81ff">3</span>,<span style="color:#ae81ff">1</span>, <span style="color:#66d9ef">None</span>, <span style="color:#ae81ff">6</span>], name<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;linear-isoquant&#34;</span>,   textfont<span style="color:#f92672">=</span>dict(size<span style="color:#f92672">=</span><span style="color:#ae81ff">28</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;green&#34;</span>),
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39</span><span>                           text<span style="color:#f92672">=</span>[<span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">&#34;&#34;</span>, <span style="color:#e6db74">r</span><span style="color:#e6db74">&#34;$\frac{\Delta (l/k)}{\Delta (w/r)} =\infty$&#34;</span>], mode<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;lines+text&#34;</span>, line<span style="color:#f92672">=</span>dict(width<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>, color<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;red&#34;</span>)), row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> )
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43</span><span>fig2<span style="color:#f92672">.</span>update_xaxes(title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;k&#34;</span>, row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44</span><span>fig2<span style="color:#f92672">.</span>update_xaxes(title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;k&#34;</span>, range<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>], row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45</span><span>fig2<span style="color:#f92672">.</span>update_yaxes(title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;k&#34;</span>, range<span style="color:#f92672">=</span>[<span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">9</span>], row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46</span><span>fig2<span style="color:#f92672">.</span>update_xaxes(title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;k&#34;</span>, showgrid<span style="color:#f92672">=</span><span style="color:#66d9ef">False</span>, row<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span>, col<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48</span><span>
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49</span><span>fig2<span style="color:#f92672">.</span>update_layout(height<span style="color:#f92672">=</span><span style="color:#ae81ff">600</span>, width<span style="color:#f92672">=</span><span style="color:#ae81ff">1800</span>, title_text<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;contours of CES&#34;</span>)
</span></span><span style="display:flex;"><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50</span><span>fig2<span style="color:#f92672">.</span>show()
</span></span></code></pre></div>

<div id="/image/CES/ces3cases_sigma.json" class="plotly" style="height:900px"></div>
<script>
d3.json("/image/CES/ces3cases_sigma.json", function(err, fig) {
    Plotly.newPlot('\/image\/CES\/ces3cases_sigma.json', fig.data, fig.layout, {responsive: true});
});
</script>

<p>For CD production function, the relative factor usage for a cost-minization firm responses in the same amount as the relative factor price change, i.e, $$\frac{\Delta (l/k)}{\Delta (w/r)} =1$$
For Leontief production function, the optimal factor usage(or factor demand function) remains the same in response of factor prices change, namely, $\Delta(l/k)=0$ given $\Delta(w/k)\neq0$, thus $$\frac{\Delta (l/k)}{\Delta (w/r)} =0$$
For linear production function, a change in relative price change the relative factor usage from 0 to $\infty$, thus $$\frac{\Delta (l/k)}{\Delta (w/r)} =\infty$$</p>

    <hr>

  <footer>
  
  
  </footer>
  </body>
</html>

